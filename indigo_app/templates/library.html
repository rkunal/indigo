{% extends "layout.html" %}

{% block title %}Library{% endblock %}

{% block header %}
  <div class="input-group header-search-box">
    <span class="input-group-addon"><i class="fa fa-search"></i></span>
    <input type="text" class="form-control filter-search" placeholder="Search documents">
  </div>
{% endblock %}

{% block content %}

<div class="sidebar library-sidebar">
  <div class="boxed-group-inner">
    <div id="filters">
    </div>
  </div>
</div>

<div class="workspace-content">
  <div class="boxed-group-inner">
    <div id="library">
    </div>
  </div>
</div>

{% endblock %}

{% block js %}
{{ block.super }}

<script id="search-results-template" type="text/x-handlebars-template">
{% verbatim %}

<table class="table table-condensed table-hover tablesorter document-list-table">
  <thead>
    <tr>
      <th class="title">Title</th>
      <th class="year">Year</th>
      <th class="number">Number</th>
      <th class="updated">Updated</th>
    </tr>
  </thead>
  <tbody>
    {{#each documents}}
      <tr>
        <td>
          {{#if draft}}
            <i class="fa fa-fw fa-circle draft" title="draft"></i>
          {{else}}
            <i class="fa fa-fw fa-circle published" title="published"></i>
          {{/if}}
          <a href="/documents/{{ id }}">
            {{#if title}}
              {{ title }}
            {{else}}
              (untitled)
            {{/if}}
          </a>

          {{#if amended_versions}}
            <span class="text-muted">@ {{ expression_date }}</span>
          {{/if}}

          {{#if amendments}}
            <i class="fa fa-fw fa-edit" title="amended"></i>
          {{/if}}

          {{#if stub}}
            <span class="label label-info">stub</span>
          {{/if}}

          {{#each tags}}
            <span class="label label-default">{{this}}</span>
          {{/each}}
        </td>
        <td>{{ year }}</td>
        <td>{{ number }}</td>
        <td>
          <span class="hidden">{{ updated_at }}</span>
          <span class="time-ago" data-timestamp="{{ updated_at }}">{{ updated_at }}</span>
        </td>
      </tr>
    {{/each}}
  </tbody>
  <tfoot>
    <tr>
      <td class="active" colspan="5">{{ count }} documents</td>
    </tr>
  </tfoot>
</table>
{% endverbatim %}

</script>

<script id="filters-template" type="text/x-handlebars-template">
{% verbatim %}

<section>
  <div class="btn-group" data-toggle="buttons">
    <label class="btn btn-default btn-sm active">
      <input type="radio" name="options" autocomplete="off" class="filter-status" value="all" checked>All
    </label>
    <label class="btn btn-default btn-sm ">
      <input type="radio" name="options" autocomplete="off" class="filter-status" value="published"><i class="fa fa-fw fa-circle published"></i>Published
    </label>
    <label class="btn btn-default btn-sm">
      <input type="radio" name="options" autocomplete="off" class="filter-status" value="draft"><i class="fa fa-fw fa-circle draft"></i>Draft
    </label>
  </div>
</section>

{{#if summary.show_countries}}
<section>
  <ul class="nav nav-pills nav-stacked">
    <li class="active">
      <a href="#" class="filter-country" data-country="">All countries <span class="badge">{{ count }}</span></a>
    </li>
    {{#each summary.countries}}
    <li>
      <a href="#" class="filter-country" data-country="{{this.code}}">{{this.name}} <span class="badge">{{this.count}}</span></a>
    </li>
    {{/each}}
  </ul>
</section>
{{/if}}

{{#if summary.localities}}
<section>
  <ul class="nav nav-pills nav-stacked">
    <li class="active">
      <a href="#" class="filter-locality" data-locality="">All localities <span class="badge">{{ count }}</span></a>
    </li>
    {{#each summary.localities}}
    <li>
      <a href="#" class="filter-locality" data-locality="{{this.code}}">{{this.name}} <span class="badge">{{this.count}}</span></a>
    </li>
    {{/each}}
  </ul>
</section>
{{/if}}

<section class="tag-filters">
  {{#each summary.tags}}
  <a href="#" class="label label-default filter-tag" data-tag="{{this.tag}}">{{this.tag}} <span class="badge">{{this.count}}</span></a>
  {{/each}}
</section>
{% endverbatim %}
</script>

{# inject country code-to-name mappings into JS #}
<script type="text/javascript">
if (!window.Indigo) window.Indigo = {};
window.Indigo.countries = {{ countries_json|safe }};
</script>

{% endblock %}
